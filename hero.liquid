{% liquid
  assign widths = '300, 450, 600, 750, 900, 1050, 1200, 1350, 1500, 1650, 1800, 1950, 2000, 2500, 3000, 3500, 4000, 5000'
%}

{% capture media %}
  {% if section.settings.image != blank %}
    {{ section.settings.image
       | image_url: width: 3840
       | image_tag:
         width: section.settings.image.width,
         widths: widths,
         height: section.settings.image.height,
         alt: section.settings.image.alt,
         class: 'dog hero__image',
         sizes: '100vw',
         loading: 'eager',
         fetchpriority: 'high' }}
  {% endif %}

  {% if section.settings.bowl_image != blank %}
    {{ section.settings.bowl_image
       | image_url: width: 600
       | image_tag:
         class: 'bowl',
         alt: 'Dog Bowl',
         loading: 'lazy' }}
  {% endif %}
{% endcapture %}

<div id="Hero-{{ section.id }}" class="hero color-{{ section.settings.color_scheme }}" style="--hero-min-height: 100svh;">
  <div class="hero__container spacing-style section section--full-width" style="{% render 'spacing-style', settings: section.settings %}">
    <div class="hero__media-wrapper">
      {% if section.settings.badge_text != blank %}
        <div class="vet-badge">{{ section.settings.badge_text }}</div>
      {% endif %}
      {{ media }}
    </div>
    <div class="hero__content-wrapper layout-panel-flex layout-panel-flex--column {{ section.settings.section_width }}">
      {% for block in section.blocks %}
        {% case block.type %}
          {% when 'heading' %}
            <h1 {{ block.shopify_attributes }}>{{ block.settings.heading }}</h1>
          {% when 'text' %}
            <p {{ block.shopify_attributes }}>{{ block.settings.text }}</p>
          {% when 'button' %}
            <a {{ block.shopify_attributes }} href="{{ block.settings.link }}" class="button">{{ block.settings.label }}</a>
        {% endcase %}
      {% endfor %}
    </div>
  </div>
</div>

{% stylesheet %}
.hero {
  position: relative;
  min-height: var(--hero-min-height);
}

.hero::before {
  content: '';
  position: absolute;
  top: 0;
  right: -20%;
  width: 75%;
  height: 100%;
  background-color: {{ section.settings.shape_color }};
  border-top-left-radius: 100% 50%;
  border-bottom-left-radius: 100% 50%;
  z-index: 0;
}

.hero__container {
  position: relative;
  overflow: hidden;
}

.hero__media-wrapper {
  position: absolute;
  inset: 0;
  display: flex;
  justify-content: center;
  align-items: flex-end;
  pointer-events: none;
}

.hero__content-wrapper {
  position: relative;
  z-index: 2;
  pointer-events: auto;
  text-align: center;
}

.dog.hero__image {
  width: 100%;
  max-width: 450px;
  height: auto;
  z-index: 2;
}

.bowl {
  max-width: 140px;
  position: absolute;
  bottom: 0;
  left: 25%;
  z-index: 1;
}

.vet-badge {
  position: absolute;
  top: 25%;
  left: 10%;
  background-color: #1E2D32;
  color: white;
  padding: 0.75rem 1rem;
  border-radius: 50%;
  font-size: 0.8rem;
  font-weight: bold;
  text-align: center;
  z-index: 3;
  line-height: 1.2;
}

@media screen and (min-width: 750px) {
  .hero__content-wrapper {
    text-align: left;
  }
}
{% endstylesheet %}

{% schema %}
{
  "name": "Hero",
  "tag": "section",
  "class": "hero-wrapper section-wrapper",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Main Image"
    },
    {
      "type": "image_picker",
      "id": "bowl_image",
      "label": "Dog Bowl Image"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Vet Badge Text",
      "default": "Approved<br>by Vets"
    },
    {
      "type": "color",
      "id": "shape_color",
      "label": "Background Shape Color",
      "default": "#E8F6FA"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Content width",
      "options": [
        {"value": "page-width", "label": "Page"},
        {"value": "full-width", "label": "Full"}
      ],
      "default": "page-width"
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "Heading",
      "settings": [
        {"type": "text", "id": "heading", "label": "Heading", "default": "Welcome"}
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "settings": [
        {"type": "textarea", "id": "text", "label": "Text", "default": "Add your text"}
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "settings": [
        {"type": "text", "id": "label", "label": "Label", "default": "Shop now"},
        {"type": "url", "id": "link", "label": "Link"}
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero",
      "category": "Banners",
      "blocks": {
        "heading": {
          "type": "heading",
          "settings": {"heading": "Welcome"}
        },
        "text": {
          "type": "text",
          "settings": {"text": "Add a short description here."}
        },
        "button": {
          "type": "button",
          "settings": {"label": "Shop Now", "link": "shopify://collections/all"}
        }
      },
      "block_order": ["heading", "text", "button"],
      "settings": {}
    }
  ]
}
{% endschema %}
